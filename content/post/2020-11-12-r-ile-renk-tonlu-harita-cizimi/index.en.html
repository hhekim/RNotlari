---
title: R ile renk tonlu harita çizimi
author: Hakan Hekim
date: '2020-11-12'
slug: r-ile-renk-tonlu-harita-cizimi/
categories:
  - Grafik
tags:
  - GIS
  - Choropleth
description: R ile Türkiye haritası çizimi ve renk tonlarıyla veri yerleştirme.
featured: yes
#toc: no
#featureImage: /images/path/file.jpg
thumbnail: /images/thumbs/tr-se_tn.jpg
shareImage: /logos/slogo.jpeg
codeMaxLines: 10
codeLineNumbers: no
figurePositionShow: yes
---

<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<p>Bu yazıda R ile harita cizerek, çizdiğimiz haritayı veriye göre renklendireceğim yani renk tonlu harita (choroplet) çizeceğim. R ile harita çizmeyi sağlayan birçok paket var. Bu yazıda harita paketlerine girmeyecek <code>ggplot</code> kullanacağım. Fakat hataları en aza indirmek için <code>rgdal</code>, <code>rgeos</code>, <code>sf</code> ve <code>sp</code> paketlerini yüklemenizde fayda var.</p>
<p>Yine Türkiye haritası çizmenin de birden fazla yöntemi var. Ben burada <a href="https://data.humdata.org/dataset/turkey-administrative-boundaries-levels-0-1-2/resource/6cc83f12-885f-475b-98f7-9bad99d682b9">HDX</a> sitesinden indirdiğim Spatial Polygon verisetini kullanacağım. Önce veriyi R’a aktaralım:</p>
<pre class="r"><code>library(rgdal)
library(tidyverse)
trShp1 &lt;- readOGR( 
  dsn= &quot;turkey_administrative/&quot;,
  layer=&quot;tur_polbnda_adm1&quot;,
  verbose=FALSE
)</code></pre>
<p>R’a aktardığımız Spatial Polygon türü veriyi <code>ggplot</code> ile kullanabilmek için dataframe’e dönüştürelim:</p>
<pre class="r"><code>trShp1_df = fortify(trShp1, region = &quot;adm1_tr&quot;)
trShp1_df$id &lt;- tolower(trShp1_df$id)</code></pre>
<p>Ben bu yazıda illeri sosyo-ekonomik düzeylerine göre renklendireceğim. İllerin sosyo-ekonomik durum verisini internetten edindim. Siz illere ait başka bir veri bulup onu haritalandırabilirsiniz. Burada önemli olan iki şey:</p>
<ol style="list-style-type: decimal">
<li>Benim yaptığım gibi il adlarını haritaya eklemek istiyorsanız, illerin lat, long verisini de eklemeniz gerekiyor. Bu veriyi de internetten rahatlıkla bulabilirisiniz ve Excel tarzı bir programla iki veriyi birleştirebilirisiniz.</li>
<li>Değişken adlarını değiştirmeyi unutmayın.
Sosyo-ekonomik veriyi R’a yüklüyorum:</li>
</ol>
<pre class="r"><code>tr_se &lt;- read_csv(&quot;tr.socio.eco.csv&quot;)
tr_se$id &lt;- tolower(tr_se$id)
#tr_se$se_value &lt;- tr_se$se_value + 2</code></pre>
<p>Son olarak haritayı çiziyorum:</p>
<pre class="r"><code>ggplot(tr_se, aes(map_id = id)) + 
  geom_map(aes(fill = se_value), map =trShp1_df) +
  expand_limits(x = trShp1_df$long, y = trShp1_df$lat) + 
  scale_fill_distiller(name = &quot;&quot;, palette = &quot;Spectral&quot;) +
  coord_fixed(1.3) +
  geom_text(data = tr_se, 
            aes(x = tr_se$lng, 
                y = tr_se$lat, label = paste(toupper(substr(tr_se$id, 1, 1)), substr(tr_se$id, 2, nchar(tr_se$id)), sep=&quot;&quot;)),
            size = 2, hjust = 0.75) +
  labs(title = &quot;Socio-Economic Development, 2003&quot;, x = element_blank(), y = element_blank(), 
       fill=&#39;2013`&#39;) +   theme(legend.position = &quot;bottom&quot;) +
  theme(panel.background = element_blank())</code></pre>
<p><img src="/post/2020-11-12-r-ile-renk-tonlu-harita-cizimi/index.en_files/tr-se.png" /></p>
<p>Sosyo-ekonomik düzeyi en düşük iller mavi, en yüksek iller kırmızı olmak üzere iller indeks değerlerine göre renklendi.<code>ggplot</code> baskıda güzel görünecek haritalar üretmemizi sağlıyor. <code>leaflet</code> ve <code>tmap</code> gibi paketlerle web sayfalarında kullanılabilecek interaktif haritalar üretebilirsiniz.</p>
